# Soma - Backend Service

## üéµ –û –ø—Ä–æ–µ–∫—Ç–µ

Soma - —ç—Ç–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –º—É–∑—ã–∫–∞–ª—å–Ω—ã—Ö –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤ –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –º–µ–∂–¥—É –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–º–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π.

**–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- üîÑ –ü–µ—Ä–µ–Ω–æ—Å –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤ –º–µ–∂–¥—É Spotify, YouTube Music, Yandex Music –∏ –¥—Ä—É–≥–∏–º–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏
- üìä –ê–≥—Ä–µ–≥–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π —Å–æ –≤—Å–µ—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

**Backend:**
- Java 21
- Spring Boot 3.5
- Spring Security —Å OAuth 2.0
- PostgreSQL
- Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- Maven

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
- Spotify Web API
- YouTube Data API
- Yandex Music API
- Apple Music API (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

**–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- Docker & Docker Compose
- Nginx
- AWS/Google Cloud
- GitHub Actions CI/CD

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Java 21 –∏–ª–∏ –≤—ã—à–µ
- PostgreSQL 14+
- Redis 6+
- Maven 3.6+

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è**
```bash
git clone https://github.com/volshhhh/soma_backend.git
cd soma-backend
```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**
```bash
# –ó–∞–ø—É—Å–∫ PostgreSQL –∏ Redis —á–µ—Ä–µ–∑ Docker
docker-compose up -d postgres redis
```

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**
```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
```

4. **–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
```bash
mvn spring-boot:run
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8080`

### Docker deployment

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞
docker-compose up -d

# –¢–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up -d app postgres redis
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `application.yml`:

```yaml
server:
  port: 8080

spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/soma
    username: soma_user
    password: ${DB_PASSWORD}
  
  security:
    oauth2:
      client:
        registration:
          spotify:
            client-id: ${SPOTIFY_CLIENT_ID}
            client-secret: ${SPOTIFY_CLIENT_SECRET}
```

## üîê API Endpoints

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `POST /api/auth/login/{provider}` - OAuth –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `POST /api/auth/logout` - –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
- `GET /api/auth/me` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

### –ü–ª–µ–π–ª–∏—Å—Ç—ã
- `GET /api/playlists` - –°–ø–∏—Å–æ–∫ –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `POST /api/playlists/transfer` - –ü–µ—Ä–µ–Ω–æ—Å –ø–ª–µ–π–ª–∏—Å—Ç–∞ –º–µ–∂–¥—É –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏
- `GET /api/playlists/{id}/status` - –°—Ç–∞—Ç—É—Å –ø–µ—Ä–µ–Ω–æ—Å–∞

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `GET /api/stats/listening-history` - –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π
- `GET /api/stats/top-artists` - –¢–æ–ø –∞—Ä—Ç–∏—Å—Ç–æ–≤
- `GET /api/stats/top-tracks` - –¢–æ–ø —Ç—Ä–µ–∫–æ–≤
- `GET /api/stats/genres` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∂–∞–Ω—Ä–∞–º

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
mvn test

# –ó–∞–ø—É—Å–∫ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –æ—Ç—á–µ—Ç–∞ –ø–æ–∫—Ä—ã—Ç–∏—è
mvn jacoco:report

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
mvn verify -P integration-test
```

## ü§ù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
